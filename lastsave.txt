> data("AirPassengers")
> library(TSstudio)
Error in library(TSstudio) : there is no package called ‘TSstudio’
> ts_info(AirPassengers)
Error in ts_info(AirPassengers) : could not find function "ts_info"
> install.packages("TSstudio")
Warning in install.packages("TSstudio") :
  'lib = "C:/Program Files/R/R-4.5.1/library"' is not writable
--- Please select a CRAN mirror for use in this session ---
also installing the dependencies ‘fs’, ‘rappdirs’, ‘sys’, ‘cachem’, ‘memoise’, ‘sass’, ‘TTR’, ‘SparseM’, ‘RcppEigen’, ‘askpass’, ‘evaluate’, ‘highr’, ‘xfun’, ‘bslib’, ‘fontawesome’, ‘jquerylib’, ‘tinytex’, ‘utf8’, ‘pkgconfig’, ‘gtable’, ‘isoband’, ‘quadprog’, ‘quantmod’, ‘hts’, ‘iterators’, ‘curl’, ‘mime’, ‘openssl’, ‘fastmap’, ‘knitr’, ‘rmarkdown’, ‘yaml’, ‘later’, ‘stringi’, ‘BH’, ‘cli’, ‘generics’, ‘glue’, ‘lifecycle’, ‘pillar’, ‘R6’, ‘rlang’, ‘tibble’, ‘tidyselect’, ‘vctrs’, ‘colorspace’, ‘fracdiff’, ‘ggplot2’, ‘lmtest’, ‘Rcpp’, ‘timeDate’, ‘tseries’, ‘urca’, ‘withr’, ‘RcppArmadillo’, ‘thief’, ‘doParallel’, ‘foreach’, ‘timechange’, ‘httr’, ‘jsonlite’, ‘digest’, ‘viridisLite’, ‘base64enc’, ‘htmltools’, ‘htmlwidgets’, ‘lazyeval’, ‘crosstalk’, ‘promises’, ‘plyr’, ‘stringr’, ‘farver’, ‘labeling’, ‘cpp11’, ‘anytime’, ‘ellipsis’, ‘gridExtra’, ‘data.table’, ‘dplyr’, ‘forecast’, ‘forecastHybrid’, ‘lubridate’, ‘magrittr’, ‘plotly’, ‘purrr’, ‘RColorBrewer’, ‘reshape2’, ‘scales’, ‘tidyr’, ‘tsibble’, ‘viridis’, ‘xts’, ‘zoo’

trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/fs_1.6.6.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/rappdirs_0.3.3.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/sys_3.4.3.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/cachem_1.1.0.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/memoise_2.0.1.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/sass_0.4.10.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/TTR_0.24.4.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/SparseM_1.84-2.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/RcppEigen_0.3.4.0.2.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/askpass_1.2.1.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/evaluate_1.0.4.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/highr_0.11.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/xfun_0.52.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/bslib_0.9.0.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/fontawesome_0.5.3.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/jquerylib_0.1.4.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/tinytex_0.57.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/utf8_1.2.6.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/pkgconfig_2.0.3.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/gtable_0.3.6.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/isoband_0.2.7.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/quadprog_1.5-8.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/quantmod_0.4.28.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/hts_6.0.3.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/iterators_1.0.14.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/curl_6.4.0.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/mime_0.13.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/openssl_2.3.3.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/fastmap_1.2.0.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/knitr_1.50.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/rmarkdown_2.29.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/yaml_2.3.10.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/later_1.4.2.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/stringi_1.8.7.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/BH_1.87.0-1.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/cli_3.6.5.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/generics_0.1.4.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/glue_1.8.0.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/lifecycle_1.0.4.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/pillar_1.11.0.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/R6_2.6.1.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/rlang_1.1.6.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/tibble_3.3.0.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/tidyselect_1.2.1.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/vctrs_0.6.5.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/colorspace_2.1-1.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/fracdiff_1.5-3.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/ggplot2_3.5.2.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/lmtest_0.9-40.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/Rcpp_1.1.0.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/timeDate_4041.110.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/tseries_0.10-58.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/urca_1.3-4.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/withr_3.0.2.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/RcppArmadillo_14.6.0-1.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/thief_0.3.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/doParallel_1.0.17.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/foreach_1.5.2.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/timechange_0.3.0.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/httr_1.4.7.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/jsonlite_2.0.0.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/digest_0.6.37.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/viridisLite_0.4.2.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/base64enc_0.1-3.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/htmltools_0.5.8.1.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/htmlwidgets_1.6.4.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/lazyeval_0.2.2.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/crosstalk_1.2.1.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/promises_1.3.3.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/plyr_1.8.9.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/stringr_1.5.1.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/farver_2.1.2.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/labeling_0.4.3.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/cpp11_0.5.2.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/anytime_0.3.11.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/ellipsis_0.3.2.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/gridExtra_2.3.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/data.table_1.17.6.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/dplyr_1.1.4.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/forecast_8.24.0.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/forecastHybrid_5.1.20.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/lubridate_1.9.4.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/magrittr_2.0.3.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/plotly_4.11.0.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/purrr_1.0.4.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/RColorBrewer_1.1-3.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/reshape2_1.4.4.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/scales_1.4.0.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/tidyr_1.3.1.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/tsibble_1.1.6.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/viridis_0.6.5.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/xts_0.14.1.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/zoo_1.8-14.zip'
trying URL 'https://cloud.r-project.org/bin/windows/contrib/4.5/TSstudio_0.1.7.zip'
package ‘fs’ successfully unpacked and MD5 sums checked
package ‘rappdirs’ successfully unpacked and MD5 sums checked
package ‘sys’ successfully unpacked and MD5 sums checked
package ‘cachem’ successfully unpacked and MD5 sums checked
package ‘memoise’ successfully unpacked and MD5 sums checked
package ‘sass’ successfully unpacked and MD5 sums checked
package ‘TTR’ successfully unpacked and MD5 sums checked
package ‘SparseM’ successfully unpacked and MD5 sums checked
package ‘RcppEigen’ successfully unpacked and MD5 sums checked
package ‘askpass’ successfully unpacked and MD5 sums checked
package ‘evaluate’ successfully unpacked and MD5 sums checked
package ‘highr’ successfully unpacked and MD5 sums checked
package ‘xfun’ successfully unpacked and MD5 sums checked
package ‘bslib’ successfully unpacked and MD5 sums checked
package ‘fontawesome’ successfully unpacked and MD5 sums checked
package ‘jquerylib’ successfully unpacked and MD5 sums checked
package ‘tinytex’ successfully unpacked and MD5 sums checked
package ‘utf8’ successfully unpacked and MD5 sums checked
package ‘pkgconfig’ successfully unpacked and MD5 sums checked
package ‘gtable’ successfully unpacked and MD5 sums checked
package ‘isoband’ successfully unpacked and MD5 sums checked
package ‘quadprog’ successfully unpacked and MD5 sums checked
package ‘quantmod’ successfully unpacked and MD5 sums checked
package ‘hts’ successfully unpacked and MD5 sums checked
package ‘iterators’ successfully unpacked and MD5 sums checked
package ‘curl’ successfully unpacked and MD5 sums checked
package ‘mime’ successfully unpacked and MD5 sums checked
package ‘openssl’ successfully unpacked and MD5 sums checked
package ‘fastmap’ successfully unpacked and MD5 sums checked
package ‘knitr’ successfully unpacked and MD5 sums checked
package ‘rmarkdown’ successfully unpacked and MD5 sums checked
package ‘yaml’ successfully unpacked and MD5 sums checked
package ‘later’ successfully unpacked and MD5 sums checked
package ‘stringi’ successfully unpacked and MD5 sums checked
package ‘BH’ successfully unpacked and MD5 sums checked
package ‘cli’ successfully unpacked and MD5 sums checked
package ‘generics’ successfully unpacked and MD5 sums checked
package ‘glue’ successfully unpacked and MD5 sums checked
package ‘lifecycle’ successfully unpacked and MD5 sums checked
package ‘pillar’ successfully unpacked and MD5 sums checked
package ‘R6’ successfully unpacked and MD5 sums checked
package ‘rlang’ successfully unpacked and MD5 sums checked
package ‘tibble’ successfully unpacked and MD5 sums checked
package ‘tidyselect’ successfully unpacked and MD5 sums checked
package ‘vctrs’ successfully unpacked and MD5 sums checked
package ‘colorspace’ successfully unpacked and MD5 sums checked
package ‘fracdiff’ successfully unpacked and MD5 sums checked
package ‘ggplot2’ successfully unpacked and MD5 sums checked
package ‘lmtest’ successfully unpacked and MD5 sums checked
package ‘Rcpp’ successfully unpacked and MD5 sums checked
package ‘timeDate’ successfully unpacked and MD5 sums checked
package ‘tseries’ successfully unpacked and MD5 sums checked
package ‘urca’ successfully unpacked and MD5 sums checked
package ‘withr’ successfully unpacked and MD5 sums checked
package ‘RcppArmadillo’ successfully unpacked and MD5 sums checked
package ‘thief’ successfully unpacked and MD5 sums checked
package ‘doParallel’ successfully unpacked and MD5 sums checked
package ‘foreach’ successfully unpacked and MD5 sums checked
package ‘timechange’ successfully unpacked and MD5 sums checked
package ‘httr’ successfully unpacked and MD5 sums checked
package ‘jsonlite’ successfully unpacked and MD5 sums checked
package ‘digest’ successfully unpacked and MD5 sums checked
package ‘viridisLite’ successfully unpacked and MD5 sums checked
package ‘base64enc’ successfully unpacked and MD5 sums checked
package ‘htmltools’ successfully unpacked and MD5 sums checked
package ‘htmlwidgets’ successfully unpacked and MD5 sums checked
package ‘lazyeval’ successfully unpacked and MD5 sums checked
package ‘crosstalk’ successfully unpacked and MD5 sums checked
package ‘promises’ successfully unpacked and MD5 sums checked
package ‘plyr’ successfully unpacked and MD5 sums checked
package ‘stringr’ successfully unpacked and MD5 sums checked
package ‘farver’ successfully unpacked and MD5 sums checked
package ‘labeling’ successfully unpacked and MD5 sums checked
package ‘cpp11’ successfully unpacked and MD5 sums checked
package ‘anytime’ successfully unpacked and MD5 sums checked
package ‘ellipsis’ successfully unpacked and MD5 sums checked
package ‘gridExtra’ successfully unpacked and MD5 sums checked
package ‘data.table’ successfully unpacked and MD5 sums checked
package ‘dplyr’ successfully unpacked and MD5 sums checked
package ‘forecast’ successfully unpacked and MD5 sums checked
package ‘forecastHybrid’ successfully unpacked and MD5 sums checked
package ‘lubridate’ successfully unpacked and MD5 sums checked
package ‘magrittr’ successfully unpacked and MD5 sums checked
package ‘plotly’ successfully unpacked and MD5 sums checked
package ‘purrr’ successfully unpacked and MD5 sums checked
package ‘RColorBrewer’ successfully unpacked and MD5 sums checked
package ‘reshape2’ successfully unpacked and MD5 sums checked
package ‘scales’ successfully unpacked and MD5 sums checked
package ‘tidyr’ successfully unpacked and MD5 sums checked
package ‘tsibble’ successfully unpacked and MD5 sums checked
package ‘viridis’ successfully unpacked and MD5 sums checked
package ‘xts’ successfully unpacked and MD5 sums checked
package ‘zoo’ successfully unpacked and MD5 sums checked
package ‘TSstudio’ successfully unpacked and MD5 sums checked

The downloaded binary packages are in
        C:\Users\user-10\AppData\Local\Temp\RtmpcdBRYW\downloaded_packages
> library(TSstudio)
> ts_info(AirPassengers)
 The AirPassengers series is a ts object with 1 variable and 144 observations
 Frequency: 12 
 Start time: 1949 1 
 End time: 1960 12 
> ts_info(AirPassengers)
 The AirPassengers series is a ts object with 1 variable and 144 observations
 Frequency: 12 
 Start time: 1949 1 
 End time: 1960 12 
> ts_plot(AirPassengers,
+         slider = TRUE,
+         title = "Monthly Airline Passenger Numbers 1949-1960",
+         Ytitle = "Thousands of Passengers",
+         Xtitle = paste("Time Series Analysis, Forecasting and Control"))
> 
> data("AirPassengers")
> d <- decompose(AirPassengers)
> str(d)
List of 6
 $ x       : Time-Series [1:144] from 1949 to 1961: 112 118 132 129 121 135 148 148 136 119 ...
 $ seasonal: Time-Series [1:144] from 1949 to 1961: -24.75 -36.19 -2.24 -8.04 -4.51 ...
 $ trend   : Time-Series [1:144] from 1949 to 1961: NA NA NA NA NA ...
 $ random  : Time-Series [1:144] from 1949 to 1961: NA NA NA NA NA ...
 $ figure  : num [1:12] -24.75 -36.19 -2.24 -8.04 -4.51 ...
 $ type    : chr "additive"
 - attr(*, "class")= chr "decomposed.ts"
> plot(d)
> d_m <- decompose(AirPassengers, type = "multiplicative")
> plot(d_m)
> ts_decompose(AirPassengers, type = "both") 
> library(plotly)
Loading required package: ggplot2
Learn more about the underlying theory at https://ggplot2-book.org/

Attaching package: ‘plotly’

The following object is masked from ‘package:ggplot2’:

    last_plot

The following object is masked from ‘package:stats’:

    filter

The following object is masked from ‘package:graphics’:

    layout

> library(dplyr)

Attaching package: ‘dplyr’

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

> library(lubridate)

Attaching package: ‘lubridate’

The following objects are masked from ‘package:base’:

    date, intersect, setdiff, union

> ap_smooth <- ts_ma(AirPassengers, n = 6,
+                    separate = FALSE)
> ap_smooth$plot %>%
+   layout(legend = list(x = 0.1, y = 0.9))
> df <- ts_to_prophet(AirPassengers) %>% 
+   select(date = ds, y) %>% 
+   left_join(ts_to_prophet(ap_smooth$ma_6) %>%
+               select(date = ds, trend = y), by = "date")
> 
> head(df, 8)
        date   y    trend
1 1949-01-01 112       NA
2 1949-02-01 118       NA
3 1949-03-01 132       NA
4 1949-04-01 129       NA
5 1949-05-01 121       NA
6 1949-06-01 135       NA
7 1949-07-01 148 125.7692
8 1949-08-01 148 126.8462
> df$detrend <- df$y - df$trend
> head(df, 8)
        date   y    trend  detrend
1 1949-01-01 112       NA       NA
2 1949-02-01 118       NA       NA
3 1949-03-01 132       NA       NA
4 1949-04-01 129       NA       NA
5 1949-05-01 121       NA       NA
6 1949-06-01 135       NA       NA
7 1949-07-01 148 125.7692 22.23077
8 1949-08-01 148 126.8462 21.15385
> ts_plot(df,
+         title = "AirPassenger Detrending") %>%
+   layout(legend = list(x = 0.1, y = 0.9))
> 
> df$year <- year(df$date)
> df$month = month(df$date)
> p= plot_ly()
> for(i in unique(df$year)){
+ temp = NULL
+ temp = df %>% add_lines(x=temp$month,
+ y=temp$detrend, name=i)}
Error: Must supply `x` and `y` attributes
> temp = df %>% add_lines(x=temp$month, y= temp$detrend, name=i)}
Error: unexpected '}' in "temp = df %>% add_lines(x=temp$month, y= temp$detrend, name=i)}"
> for(i in unique(df$year)){
+ temp=NULL
+ temp= df %>% filter(year ==i)
+ p= p %>% add_lines(x= temp$month, y= temp$detrend, name= i)
+ }
> p
> seasonal_comp = df %>%
+ group_by(month) %>%
+ summarise(month_avg = mean(detrend, na.rm=TRUE),
+ .groups = "drop")
> p %>% add_lines(x= seasonal_comp$month, y= seasonal_comp$month_avg,
+ line=list(color = "black", dash="dash", width= 4),
+ name="Seasonal Component")
> df = df %>% left_join(seasonal_comp, by ="month")
> 
> df$irregular = df$y - df$trend - df$month_avg
> head(df)
        date   y trend detrend year month   month_avg irregular
1 1949-01-01 112    NA      NA 1949     1 -30.8251748        NA
2 1949-02-01 118    NA      NA 1949     2 -42.0279720        NA
3 1949-03-01 132    NA      NA 1949     3  -4.1398601        NA
4 1949-04-01 129    NA      NA 1949     4  -6.9440559        NA
5 1949-05-01 121    NA      NA 1949     5  -0.6993007        NA
6 1949-06-01 135    NA      NA 1949     6  37.1468531        NA
> ts_plot(df[,c("date","y","trend","detrend","month_avg","irregular")],
+ title="AirPassenger and its Components",
+ type="multiple")
> naturalgas_path = paste(rprojroot::find_rstudio_root_file(), "data", "NATURALGAS.CSV",SEP="/")
